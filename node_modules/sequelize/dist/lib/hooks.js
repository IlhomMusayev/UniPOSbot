"use strict";var l=Object.defineProperty;var n=(e,r)=>l(e,"name",{value:r,configurable:!0});const u=require("lodash"),{logger:m}=require("./utils/logger"),f=m.debugContext("hooks"),s={beforeValidate:{params:2},afterValidate:{params:2},validationFailed:{params:3},beforeCreate:{params:2},afterCreate:{params:2},beforeDestroy:{params:2},afterDestroy:{params:2},beforeRestore:{params:2},afterRestore:{params:2},beforeUpdate:{params:2},afterUpdate:{params:2},beforeSave:{params:2,proxies:["beforeUpdate","beforeCreate"]},afterSave:{params:2,proxies:["afterUpdate","afterCreate"]},beforeUpsert:{params:2},afterUpsert:{params:2},beforeBulkCreate:{params:2},afterBulkCreate:{params:2},beforeBulkDestroy:{params:1},afterBulkDestroy:{params:1},beforeBulkRestore:{params:1},afterBulkRestore:{params:1},beforeBulkUpdate:{params:1},afterBulkUpdate:{params:1},beforeFind:{params:1},beforeFindAfterExpandIncludeAll:{params:1},beforeFindAfterOptions:{params:1},afterFind:{params:2},beforeCount:{params:1},beforeDefine:{params:2,sync:!0,noModel:!0},afterDefine:{params:1,sync:!0,noModel:!0},beforeInit:{params:2,sync:!0,noModel:!0},afterInit:{params:1,sync:!0,noModel:!0},beforeAssociate:{params:2,sync:!0},afterAssociate:{params:2,sync:!0},beforeConnect:{params:1,noModel:!0},afterConnect:{params:2,noModel:!0},beforeDisconnect:{params:1,noModel:!0},afterDisconnect:{params:1,noModel:!0},beforeSync:{params:1},afterSync:{params:1},beforeBulkSync:{params:1},afterBulkSync:{params:1},beforeQuery:{params:2},afterQuery:{params:2}};exports.hooks=s;const c=n(e=>s[e].proxies?s[e].proxies.concat(e):[e],"getProxiedHooks");function i(e,r){return(e.options.hooks||{})[r]||[]}n(i,"getHooks");const p={_setupHooks(e){this.options.hooks={},u.map(e||{},(r,t)=>{Array.isArray(r)||(r=[r]),r.forEach(a=>this.addHook(t,a))})},async runHooks(e,...r){if(!e)throw new Error("runHooks requires at least 1 argument");let t;if(typeof e=="string"&&(t=e,e=i(this,t),this.sequelize&&(e=e.concat(i(this.sequelize,t)))),Array.isArray(e)||(e=[e]),s[t]&&s[t].sync){for(let a of e)typeof a=="object"&&(a=a.fn),f(`running hook(sync) ${t}`),a.apply(this,r);return}for(let a of e)typeof a=="object"&&(a=a.fn),f(`running hook ${t}`),await a.apply(this,r)},addHook(e,r,t){return typeof r=="function"&&(t=r,r=null),f(`adding hook ${e}`),e=c(e),e.forEach(a=>{const o=i(this,a);o.push(r?{name:r,fn:t}:t),this.options.hooks[a]=o}),this},removeHook(e,r){const t=typeof r=="function";if(!this.hasHook(e))return this;f(`removing hook ${e}`),e=c(e);for(const a of e)this.options.hooks[a]=this.options.hooks[a].filter(o=>t&&typeof o=="function"?o!==r:!t&&typeof o=="object"?o.name!==r:!0);return this},hasHook(e){return this.options.hooks[e]&&!!this.options.hooks[e].length}};p.hasHooks=p.hasHook;function d(e,r=!1){u.mixin(e,p);for(const t of Object.keys(s))r&&s[t].noModel||(e[t]=function(a,o){return this.addHook(t,a,o)})}n(d,"applyTo"),exports.applyTo=d;
//# sourceMappingURL=hooks.js.map
